{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "version": "3.0.0",
  "project": {
    "name": "Data Structure Visualizer",
    "description": "CodePen-like application for visualizing data structures with real-time animated visualization. 100% client-side, no backend.",
    "repository": "https://github.com/user/vis"
  },
  "metadata": {
    "createdAt": "2026-01-15",
    "lastUpdated": "2026-01-15",
    "methodology": "Ralph Wiggum - Autonomous AI Agent Development",
    "validationCommand": "npm run validate",
    "devServer": "npm run dev",
    "devServerPort": 5175,
    "iteration": 3,
    "testingTool": "agent-browser"
  },
  "userStories": [
    {
      "id": "UI-001",
      "category": "UI Cleanup",
      "priority": "high",
      "title": "Remove visualization helper text",
      "description": "Remove the text 'Visualizing your code execution with captured operations.' and its container from the visualization panel. This text adds clutter without providing value.",
      "acceptanceCriteria": [
        "No 'Visualizing your code execution with captured operations.' text appears anywhere in the UI",
        "The container element that held this text is also removed",
        "Visualization panel still functions correctly"
      ],
      "stepsToVerify": [
        "agent-browser navigate http://localhost:5175",
        "agent-browser snapshot -c -d 6",
        "Verify no 'Visualizing your code execution' text in snapshot"
      ],
      "affectedFiles": ["src/components/VisualizationPanel/ModeSelector.tsx"],
      "passes": true
    },
    {
      "id": "UI-002",
      "category": "UI Cleanup",
      "priority": "high",
      "title": "Remove Visualization title",
      "description": "Remove the 'Visualization' title heading and its container from the visualization panel. The panel's purpose is self-evident from its content.",
      "acceptanceCriteria": [
        "No 'Visualization' heading appears in the visualization panel",
        "The container element for the title is removed",
        "Visualization panel layout adjusts appropriately"
      ],
      "stepsToVerify": [
        "agent-browser navigate http://localhost:5175",
        "agent-browser snapshot -c -d 6",
        "Verify no 'Visualization' title heading in snapshot"
      ],
      "affectedFiles": ["src/components/VisualizationPanel/VisualizationPanel.tsx"],
      "passes": true
    },
    {
      "id": "UI-003",
      "category": "UI Enhancement",
      "priority": "high",
      "title": "Reorganize playback controls below visualization",
      "description": "Position all playback controls in a logical order below the visualization area. Controls should include: Play button, step indicator (e.g., 'Step 8 / 20'), replay button, previous step button, and next step button. Style these controls clearly as belonging to the visualization, without overlapping the visualization content.",
      "acceptanceCriteria": [
        "Play button is visible below visualization",
        "Step indicator shows current step and total (e.g., 'Step 8 / 20') next to play button",
        "Replay, previous step, and next step buttons are visible and logically ordered",
        "Controls have consistent styling that visually groups them together",
        "Controls do not overlap with the visualization content",
        "All controls function correctly when clicked"
      ],
      "stepsToVerify": [
        "agent-browser navigate http://localhost:5175/?ds=array",
        "agent-browser click on Show Solution button",
        "agent-browser click on Run all tests button",
        "sleep 1",
        "agent-browser snapshot -i",
        "Verify playback controls are below visualization and properly styled"
      ],
      "affectedFiles": [
        "src/components/VisualizationPanel/VisualizationPanel.tsx",
        "src/styles/global.css"
      ],
      "passes": true
    },
    {
      "id": "UI-004",
      "category": "UI Cleanup",
      "priority": "medium",
      "title": "Remove Show Expected button",
      "description": "Remove the 'Show Expected' button from the visualization mode buttons. The 'Compare' button already provides this functionality and having both is redundant.",
      "acceptanceCriteria": [
        "No 'Show Expected' button appears in visualization mode buttons",
        "'Compare' button still works correctly",
        "'My Execution' button still works correctly"
      ],
      "stepsToVerify": [
        "agent-browser navigate http://localhost:5175",
        "agent-browser snapshot -i",
        "Verify no 'Show Expected' button in snapshot",
        "Verify 'Compare' button is present"
      ],
      "affectedFiles": ["src/components/VisualizationPanel/ModeSelector.tsx"],
      "passes": true
    },
    {
      "id": "UI-005",
      "category": "UI Consistency",
      "priority": "medium",
      "title": "Fix inconsistent button and badge sizes in Editor header",
      "description": "The buttons and badge next to the Editor title all have different sizes. They should have consistent sizing for a polished appearance.",
      "acceptanceCriteria": [
        "All buttons in Editor header have consistent height",
        "Badge has consistent sizing relative to buttons",
        "Visual alignment is clean and professional"
      ],
      "stepsToVerify": [
        "agent-browser navigate http://localhost:5175",
        "agent-browser snapshot -i",
        "Verify buttons and badge next to Editor title have consistent sizing"
      ],
      "affectedFiles": ["src/styles/global.css", "src/components/EditorPanel/PresetSelector.css"],
      "passes": true
    },
    {
      "id": "UI-006",
      "category": "UI Bug",
      "priority": "medium",
      "title": "Fix difficulty badge not updating after Show Solution",
      "description": "The difficulty badge remains on 'easy' even after clicking 'Show Solution' which loads the solution for the currently selected test (which could be hard). The badge should reflect the actual difficulty of the active test case.",
      "acceptanceCriteria": [
        "When selecting a hard test case, badge shows 'hard'",
        "When clicking 'Show Solution', badge still reflects selected test difficulty",
        "Badge updates correctly when switching between test cases of different difficulties"
      ],
      "stepsToVerify": [
        "agent-browser navigate http://localhost:5175/?ds=array",
        "agent-browser snapshot -i",
        "Select hard test case",
        "agent-browser click on Show Solution button",
        "agent-browser snapshot -i",
        "Verify badge shows 'hard' not 'easy'"
      ],
      "affectedFiles": [
        "src/components/TestPanel/TestPanel.tsx",
        "src/components/TestPanel/TestPanel.css"
      ],
      "passes": true
    },
    {
      "id": "UI-007",
      "category": "UI Bug",
      "priority": "low",
      "title": "Fix Run icon alignment in test case items",
      "description": "The icon next to 'Run' in the test case items is not properly aligned with the text.",
      "acceptanceCriteria": [
        "Run icon is vertically centered with 'Run' text",
        "Icon spacing is consistent across all test case items"
      ],
      "stepsToVerify": [
        "agent-browser navigate http://localhost:5175",
        "agent-browser snapshot -i",
        "Verify Run icons are properly aligned in test case items"
      ],
      "affectedFiles": ["src/components/TestPanel/TestPanel.css"],
      "passes": true
    },
    {
      "id": "DATA-001",
      "category": "Test Data",
      "priority": "high",
      "title": "Use single dataset for Array test cases",
      "description": "The Array data structure uses multiple different datasets for its 3 test cases. For simplicity, use a single consistent dataset across all Array test cases.",
      "acceptanceCriteria": [
        "All 3 Array test cases use the same input dataset",
        "Test cases still have different expected outputs based on difficulty/algorithm",
        "Reference solutions pass all tests with the unified dataset"
      ],
      "stepsToVerify": [
        "Review src/lib/testing/testCases/arrayTests.ts",
        "Verify all test cases use same input data",
        "agent-browser navigate http://localhost:5175/?ds=array",
        "agent-browser click on Show Solution button",
        "agent-browser click on Run all tests button",
        "Verify all tests pass"
      ],
      "affectedFiles": ["src/lib/testing/testCases/arrayTests.ts"],
      "passes": true
    },
    {
      "id": "DATA-002",
      "category": "Test Data",
      "priority": "medium",
      "title": "Use single dataset for other data structure test cases",
      "description": "Similar to Array, all other data structures should use a single consistent dataset across their test cases for simplicity.",
      "acceptanceCriteria": [
        "LinkedList test cases use single dataset",
        "Stack test cases use single dataset",
        "Queue test cases use single dataset",
        "Binary Tree test cases use single dataset",
        "Graph test cases use single dataset",
        "HashMap test cases use single dataset",
        "All reference solutions still pass"
      ],
      "stepsToVerify": [
        "Review all test case files in src/lib/testing/testCases/",
        "Verify each data structure uses consistent input data",
        "Run Show Solution + Run All Tests for each data structure",
        "Verify all tests pass"
      ],
      "affectedFiles": [
        "src/lib/testing/testCases/linkedListTests.ts",
        "src/lib/testing/testCases/stackQueueTests.ts",
        "src/lib/testing/testCases/binaryTreeTests.ts",
        "src/lib/testing/testCases/graphTests.ts",
        "src/lib/testing/testCases/hashMapTests.ts"
      ],
      "passes": true
    },
    {
      "id": "BUG-001",
      "category": "Visualization Bug",
      "priority": "critical",
      "title": "Fix Array Compare mode showing unsorted expected output",
      "description": "In the Array data structure's 'Compare' mode, the 'Expected output' is not actually sorted. It should show the correctly sorted array.",
      "acceptanceCriteria": [
        "In Compare mode, Expected output shows properly sorted array",
        "User's execution output is shown correctly alongside",
        "Comparison clearly shows differences between user output and expected"
      ],
      "stepsToVerify": [
        "agent-browser navigate http://localhost:5175/?ds=array",
        "agent-browser click on Show Solution button",
        "agent-browser click on Run all tests button",
        "sleep 1",
        "agent-browser click on Compare button",
        "agent-browser snapshot -c -d 6",
        "Verify Expected output shows sorted array"
      ],
      "affectedFiles": ["src/lib/execution/referenceSolutionRunner.ts"],
      "passes": true
    },
    {
      "id": "BUG-002",
      "category": "Test Design",
      "priority": "high",
      "title": "Simplify Array test case to use single function",
      "description": "The Array test case appears to require 3 different function names (possibly bubbleSort, quickSort, etc.). This is not immediately clear to users. Simplify to a single function (e.g., 'sortArray') that can be implemented in different ways.",
      "acceptanceCriteria": [
        "Array tests require only a single function name (e.g., 'sortArray')",
        "Users can implement this function using any sorting algorithm",
        "Test descriptions make it clear what function to implement",
        "Reference solutions work with the simplified function name"
      ],
      "stepsToVerify": [
        "Review src/lib/testing/testCases/arrayTests.ts",
        "Verify single function name is used",
        "agent-browser navigate http://localhost:5175/?ds=array",
        "Verify skeleton code shows single function to implement",
        "agent-browser click on Show Solution button",
        "agent-browser click on Run all tests button",
        "Verify all tests pass"
      ],
      "affectedFiles": [
        "src/lib/testing/testCases/arrayTests.ts",
        "src/templates/array/index.ts",
        "src/components/EditorPanel/EditorPanel.tsx"
      ],
      "passes": true
    },
    {
      "id": "FEAT-001",
      "category": "Feature",
      "priority": "high",
      "title": "Highlight code lines during visualization playback",
      "description": "When playing steps in the visualization (via play, next, or previous buttons), highlight the corresponding lines in the code editor that triggered the visualization change. The highlight should fade away after a sensible timeout. Timing must be carefully considered: highlights should not overlap when playing continuously, but also should not flash too quickly to be visible.",
      "acceptanceCriteria": [
        "When stepping through visualization, corresponding code line(s) highlight",
        "Highlights fade away smoothly after a brief period",
        "During continuous play, highlights do not overlap awkwardly",
        "Highlights are visible long enough to be noticed (not just a flash)",
        "Previous/next step buttons trigger appropriate line highlights",
        "Play button triggers sequential highlights as animation progresses"
      ],
      "stepsToVerify": [
        "agent-browser navigate http://localhost:5175/?ds=array",
        "agent-browser click on Show Solution button",
        "agent-browser click on Run all tests button",
        "sleep 1",
        "Click next step button multiple times",
        "Verify code lines highlight and fade",
        "Click play button",
        "Verify highlights appear sequentially without overlap"
      ],
      "technicalNotes": "Consider using CodeMirror decorations for highlighting. Timeout should be around 300-500ms for visibility. Clear previous highlight before applying new one during rapid stepping. May need to track line numbers in captured operations.",
      "affectedFiles": [
        "src/components/EditorPanel/CodeMirrorEditor.tsx",
        "src/components/EditorPanel/EditorPanel.tsx",
        "src/components/VisualizationPanel/VisualizationPanel.tsx",
        "src/store/useAppStore.ts",
        "src/lib/testing/trackedArrayBundle.ts",
        "src/lib/testing/trackedLinkedListBundle.ts",
        "src/lib/testing/trackedStackBundle.ts",
        "src/lib/testing/trackedQueueBundle.ts",
        "src/lib/testing/trackedBinaryTreeBundle.ts",
        "src/lib/testing/trackedGraphBundle.ts",
        "src/lib/testing/trackedHashMapBundle.ts",
        "src/lib/testing/testRunner.ts",
        "src/lib/execution/sandbox.ts",
        "src/lib/execution/messageValidation.ts",
        "src/lib/execution/stepCapture.ts"
      ],
      "passes": true
    }
  ],
  "knownIssues": {
    "uiCleanup": [
      "UI-001: Remove 'Visualizing your code execution' helper text",
      "UI-002: Remove 'Visualization' title heading",
      "UI-004: Remove redundant 'Show Expected' button",
      "UI-005: Inconsistent button/badge sizes in Editor header",
      "UI-006: Difficulty badge not updating after Show Solution",
      "UI-007: Run icon alignment in test case items"
    ],
    "uiEnhancements": ["UI-003: Reorganize playback controls below visualization"],
    "dataConsistency": [
      "DATA-001: Array uses multiple datasets",
      "DATA-002: Other data structures use multiple datasets"
    ],
    "bugs": [
      "BUG-001: Array Compare mode shows unsorted expected output",
      "BUG-002: Array tests require multiple function names"
    ],
    "features": ["FEAT-001: Code line highlighting during playback"],
    "fixPriority": [
      "1. UI-001, UI-002 - Remove unnecessary text/titles (quick wins)",
      "2. UI-003 - Reorganize playback controls (improves UX)",
      "3. UI-004 - Remove Show Expected button",
      "4. BUG-001 - Fix Compare mode expected output",
      "5. BUG-002 - Simplify Array function names",
      "6. DATA-001 - Unify Array datasets",
      "7. FEAT-001 - Code line highlighting (complex feature)",
      "8. UI-005, UI-006, UI-007 - Polish UI details",
      "9. DATA-002 - Unify other data structure datasets"
    ]
  },
  "completionCriteria": {
    "required": [
      "All critical user stories must have passes=true",
      "All high priority user stories must have passes=true",
      "npm run validate must exit with code 0",
      "Test coverage must be >= 80%",
      "No TypeScript errors",
      "No linting errors",
      "Application loads successfully at localhost:5175 for all data structures",
      "All reference solutions execute successfully",
      "Agent-browser verification confirms all acceptance criteria met"
    ],
    "recommended": [
      "Bundle size is under 4MB",
      "All animations maintain 60fps",
      "Visualizations render correctly for all data structures",
      "No D3/React conflicts or warnings in console"
    ]
  },
  "technicalNotes": {
    "testingApproach": "Use agent-browser for automated UI verification. Each user story includes specific agent-browser commands for validation.",
    "devServer": "npm run dev starts development server at http://localhost:5175",
    "validation": "npm run validate runs all checks: lint + format + typecheck + test",
    "browserRequirements": "Chrome/Chromium required for agent-browser testing",
    "sandboxSecurity": "User code runs in sandboxed iframe with allow-scripts only",
    "performanceTargets": {
      "bundleSize": "< 4MB",
      "swcTransform": "< 10ms",
      "d3Rendering": "16ms (60fps)",
      "testExecution": "< 1s per test case"
    },
    "codeHighlightingNotes": {
      "approach": "Use CodeMirror decorations API to highlight lines",
      "timing": "300-500ms visibility, clear before new highlight during rapid steps",
      "dataRequirement": "Captured operations need to include source line numbers from instrumentation"
    }
  }
}
